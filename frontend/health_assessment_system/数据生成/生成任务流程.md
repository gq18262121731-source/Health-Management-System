# 10人虚拟数据生成 - 任务流程

## 总体目标

生成 **10 个虚拟老年人** 的 **30 天健康监测数据**，覆盖不同健康状况。

---

## 任务流程图

```
┌─────────────────────────────────────────────────────────────────────────┐
│                                                                         │
│   任务1                任务2                任务3               任务4   │
│  ┌─────────┐        ┌─────────┐         ┌─────────┐        ┌─────────┐ │
│  │ 设计    │   →    │ 生成    │    →    │ 生成    │   →    │ 验证    │ │
│  │ 用户画像 │        │ 基础信息 │         │ 健康数据 │        │ 并导出  │ │
│  └─────────┘        └─────────┘         └─────────┘        └─────────┘ │
│      │                  │                   │                   │      │
│      ▼                  ▼                   ▼                   ▼      │
│  10个人的            姓名、年龄           血压、血糖          检查数据   │
│  健康特征            身高、病史           心率、睡眠          质量并     │
│  和行为模式          用药情况             步数、体温          保存文件   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 任务1：设计用户画像

### 1.1 确定10个人的角色分配

| 编号 | 角色类型 | 数量 | 说明 |
|------|----------|------|------|
| 1-2 | 健康老人 | 2人 | 指标正常，作息规律 |
| 3-4 | 高血压患者 | 2人 | 血压偏高，服药控制 |
| 5-6 | 糖尿病/前期 | 2人 | 血糖异常，需干预 |
| 7-8 | 亚健康老人 | 2人 | 睡眠差，运动少 |
| 9-10 | 多病共存 | 2人 | 高血压+糖尿病+血脂 |

### 1.2 定义每类人的数据特征

```python
用户画像 = {
    "健康老人": {
        "血压": {"收缩压": 115-125, "舒张压": 70-80},
        "血糖": {"空腹": 4.5-5.8},
        "心率": {"静息": 65-75},
        "睡眠": {"时长": 7-8小时, "深睡": 1.5-2.5小时},
        "步数": {"日均": 6000-10000}
    },
    "高血压患者": {
        "血压": {"收缩压": 140-160, "舒张压": 90-100},  # 偏高
        ...
    }
}
```

### 任务1 输出
→ `user_profiles.py`：10个用户画像配置

---

## 任务2：生成用户基础信息

### 2.1 需要生成的字段

| 字段 | 生成规则 | 示例 |
|------|----------|------|
| user_id | elderly_001 ~ elderly_010 | elderly_003 |
| name | 随机中文姓名 | 李秀芳 |
| gender | 按比例分配 | 女 |
| age | 65-80岁 | 72 |
| height | 按性别正态分布 | 158cm |
| base_weight | 按BMI计算 | 62kg |
| medical_history | 按角色分配 | ["高血压"] |
| medications | 按病史分配 | ["络活喜"] |
| registration_date | 随机过去日期 | 2024-06-15 |

### 2.2 生成逻辑

```
1. 根据角色类型确定年龄范围
2. 随机生成姓名（姓氏库 + 名字库）
3. 根据性别生成身高（男: 165±8cm, 女: 158±6cm）
4. 根据身高和BMI范围计算体重
5. 根据角色分配病史和用药
```

### 任务2 输出
→ `users.json`：10个用户的基础信息

---

## 任务3：生成健康监测数据

### 3.1 时间范围

```
开始日期: 2024-11-05 (30天前)
结束日期: 2024-12-04 (今天)
共计: 30天 × 10人 = 300人·天
```

### 3.2 每天生成的数据

| 数据类型 | 每天次数 | 时间点 | 30天总量/人 |
|----------|----------|--------|------------|
| 血压 | 2次 | 08:00, 20:00 | 60条 |
| 血糖 | 1-2次 | 空腹/餐后 | 45条 |
| 心率 | 4次 | 每6小时 | 120条 |
| 睡眠 | 1次 | 每日汇总 | 30条 |
| 步数 | 1次 | 每日汇总 | 30条 |
| 体重 | 1次 | 早晨 | 30条 |
| 体温 | 1次 | 早晨 | 30条 |
| 血氧 | 2次 | 早晚 | 60条 |

**每人约 405 条记录，10人共约 4,050 条**

### 3.3 生成规则

```
对于每个用户:
    获取用户画像（基础值、波动范围）
    
    对于每一天:
        # 1. 生成基础值 = 画像基础值 + 日间随机偏移
        
        # 2. 添加时间规律
        if 是早晨: 血压略高（晨峰）
        if 是餐后: 血糖升高
        if 是睡眠: 心率降低
        
        # 3. 添加周规律
        if 是周末: 活动量减少、作息延后
        
        # 4. 添加随机噪声
        value += random.gauss(0, 波动标准差)
        
        # 5. 偶尔添加异常值 (3%概率)
        if random() < 0.03: 制造一个异常
```

### 3.4 数据关联性

```
血压 ←→ 心率：血压高时心率可能偏快
血糖 ←→ 体重：体重增加血糖可能上升
睡眠 ←→ 血压：睡眠差次日血压可能偏高
运动 ←→ 睡眠：运动多睡眠质量可能更好
```

### 任务3 输出
→ `health_records.json`：4,000+ 条健康记录

---

## 任务4：验证并导出

### 4.1 数据验证检查

```
□ 所有值在合理范围内？
□ 时间戳是否连续？
□ 是否有缺失数据（故意留2%）？
□ 异常值比例是否正确（约3%）？
□ 用户间数据分布是否合理？
```

### 4.2 导出格式

| 格式 | 文件 | 用途 |
|------|------|------|
| JSON | `users.json`, `health_records.json` | API导入 |
| CSV | `health_data.csv` | 数据分析 |
| SQL | `import_data.sql` | 数据库导入 |

### 4.3 数据统计报告

```
生成报告内容：
├── 用户分布（年龄、性别、健康状况）
├── 数据量统计（各类型记录数）
├── 数值分布（各指标均值、标准差）
├── 异常值统计（数量、类型）
└── 数据质量评分
```

### 任务4 输出
→ `users.json`
→ `health_records.json`  
→ `health_data.csv`
→ `生成报告.md`

---

## 执行顺序

```
Step 1: 编写 user_profiles.py      # 定义10人画像
            ↓
Step 2: 编写 user_generator.py     # 生成用户基础信息
            ↓
Step 3: 编写 health_generator.py   # 生成健康监测数据
            ↓
Step 4: 编写 data_validator.py     # 验证数据质量
            ↓
Step 5: 编写 data_exporter.py      # 导出多格式文件
            ↓
Step 6: 运行 generate_all.py       # 一键生成全部数据
```

---

## 预计产出

| 文件 | 大小估算 | 说明 |
|------|----------|------|
| users.json | ~5KB | 10个用户基础信息 |
| health_records.json | ~800KB | 4000+条健康记录 |
| health_data.csv | ~400KB | 表格格式数据 |
| 生成报告.md | ~10KB | 统计报告 |

---

## 确认清单

开始编码前，请确认：

- [ ] 10人角色分配是否合理？
- [ ] 数据类型是否需要增减？
- [ ] 30天时间范围是否合适？
- [ ] 导出格式是否满足需求？

确认后我开始编写代码。
